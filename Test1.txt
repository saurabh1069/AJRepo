# Load the Outlook COM object
Add-Type -AssemblyName 'Microsoft.Office.Interop.Outlook'
$Outlook = New-Object -ComObject Outlook.Application
$Namespace = $Outlook.GetNamespace('MAPI')

# Specify the name of your custom folder
$customFolderName = "My Custom Folder"

# Get the folder by name
$customFolder = $Namespace.Folders | ForEach-Object {
    $_.Folders | Where-Object { $_.Name -eq $customFolderName }
}

if ($customFolder -ne $null) {
    # The custom folder was found, retrieve its EntryID
    $customFolder.EntryID
} else {
    Write-Host "Custom folder '$customFolderName' not found."
}

# Release COM objects
[System.Runtime.InteropServices.Marshal]::ReleaseComObject($Outlook) | Out-Null
